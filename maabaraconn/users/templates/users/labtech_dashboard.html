{% extends 'base.html' %} {% block content %}
<h2>Welcome, {{ request.user.username }}!</h2>
<p>This is the Lab Technician Dashboard. Here, you can:</p>
<ul>
  <li>Manage lab inventory</li>
  <li>Prepare lab setups</li>
</ul>

<!-- New Section for Adding Lab Reports -->
<h3>Add a Lab Report</h3>
{% comment %} <a id= 'addLabReportLink
' href="{% url 'upload_lab_report' course_id=0 %}">Add a Lab Report</a> {% endcomment %}
<a href="" id="addLabReportLink">Add a Lab hReport</a>
  {% csrf_token %}
  <label for="course">Select Course:</label>
  <select name="course_id" id="courseSelect">
    {% for course in courses %}
    <option value="{{ course.id }}">{{ course.name }}</option>
    {% endfor %}
  </select>
  
  <input type="submit" value="Go to Add Report" />
</form>

{% comment %} the script section {% endcomment %}
<script>
  // Function to run when the page has loaded
  document.addEventListener('DOMContentLoaded', function () {
    // Select the dropdown and the link by their IDs
    var courseSelect = document.getElementById('courseSelect');
    var addLabReportLink = document.getElementById('addLabReportLink');
  
    // Function to update the link based on the selected course
    function updateLink() {
      var selectedCourseId = courseSelect.value;
      var newHref = `{% url 'upload_lab_report' course_id=0 %}`.replace('0', selectedCourseId);
      addLabReportLink.setAttribute('href', newHref);
    }
  
    // Run the updateLink function whenever the selected course changes
    courseSelect.addEventListener('change', updateLink);
  
    // Update the link immediately in case the page is reloaded
    // and a course is already selected
    updateLink();
  });
  </script>
  
  


<a href="{% url 'add_laboratory' %}">Add a New Laboratory</a>

<h2>My Lab Reports</h2>
<ul>
  {% for report in my_lab_reports %}
    <li>{{ report.title }} - {{ report.description }}</li>
  {% empty %}
    <p>No lab reports found.</p>
  {% endfor %}
</ul>

<h2>My Laboratories</h2>
<ul>
  {% for laboratory in my_laboratories %}
    <li>
      {{ laboratory.name }} - {{ laboratory.course.name }}
      <div>
        <!-- Other laboratory details here -->
        <a href="{% url 'delete_laboratory' laboratory.id %}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this laboratory?');">Delete</a>
        <!-- Link to upload template for this laboratory -->
        <a href="{% url 'lab_template_upload' lab_id=laboratory.id %}" class="btn btn-primary">Upload Template</a>
      </div>
    </li>
  {% empty %}
    <p>No laboratories found.</p>
  {% endfor %}
</ul>


<div class="container">
  <h2>Lab Templates</h2>
  <ul>
      {% for template in templates %}
      <li>
          <a href="{{ template.template_file.url }}">{{ template.name }}</a> - {{ template.course.name }}
      </li>
      {% endfor %}
  </ul>
</div>

{% endblock %}
