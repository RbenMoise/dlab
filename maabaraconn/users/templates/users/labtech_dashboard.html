{% extends 'base.html' %} {% block content %}
<h2>Welcome, {{ request.user.username }}!</h2>
<p>This is the Lab Technician Dashboard. Here, you can:</p>
<ul>
  <li>Manage lab inventory</li>
  <li>Prepare lab setups</li>
</ul>

<!-- New Section for Adding Lab Reports -->
<h3>Add a Lab Report</h3>
{% comment %} <a id= 'addLabReportLink
' href="{% url 'upload_lab_report' course_id=0 %}">Add a Lab Report</a> {% endcomment %}
<a href="" id="addLabReportLink">Add a Lab hReport</a>
  {% csrf_token %}
  <label for="course">Select Course:</label>
  <select name="course_id" id="courseSelect">
    {% for course in courses %}
    <option value="{{ course.id }}">{{ course.name }}</option>
    {% endfor %}
  </select>
  
  <input type="submit" value="Go to Add Report" />
</form>

{% comment %} the script section {% endcomment %}
<script>
  // Function to run when the page has loaded
  document.addEventListener('DOMContentLoaded', function () {
    // Select the dropdown and the link by their IDs
    var courseSelect = document.getElementById('courseSelect');
    var addLabReportLink = document.getElementById('addLabReportLink');
  
    // Function to update the link based on the selected course
    function updateLink() {
      var selectedCourseId = courseSelect.value;
      var newHref = `{% url 'upload_lab_report' course_id=0 %}`.replace('0', selectedCourseId);
      addLabReportLink.setAttribute('href', newHref);
    }
  
    // Run the updateLink function whenever the selected course changes
    courseSelect.addEventListener('change', updateLink);
  
    // Update the link immediately in case the page is reloaded
    // and a course is already selected
    updateLink();
  });
  </script>
  
  


<a href="{% url 'add_laboratory' %}">Add a New Laboratory</a>

<h2>My Lab Reports</h2>
<ul>
  {% for report in my_lab_reports %}
    <li>
      {{ report.title }} - {{ report.description }}
      <form action="{% url 'delete_lab_report' report.id %}" method="post" style="display:inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this lab report?');">Delete</button>
      </form>
    </li>
  {% empty %}
    <p>No lab reports found.</p>
  {% endfor %}
</ul>

<h2>My Laboratories</h2>
<ul>
  {% for laboratory in my_laboratories %}
    <li>
      {{ laboratory.name }} - {{ laboratory.course.name }}
      <div>
        <!-- Other laboratory details here -->
        <a href="{% url 'delete_laboratory' laboratory.id %}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this laboratory?');">Delete</a>
        <!-- Link to upload template for this laboratory -->
        <a href="{% url 'lab_template_upload' lab_id=laboratory.id %}" class="btn btn-primary">Upload Template</a>
      </div>
    </li>
  {% empty %}
    <p>No laboratories found.</p>
  {% endfor %}
</ul>


<div class="container">
  <h2>Lab Templates</h2>
  <ul>
      {% for template in templates %}
      <li>
          <a href="{% url 'add_sections_to_template' lab_template_id=template.id %}">{{ template.name }}</a>
          {{ template.title }} - <a href="{% url 'view_template_details' template.id %}">View Details</a>
          {% comment %} <a href="{{ template.template_file.url }}">{{ template.name }}</a> - {{ template.course.name }} {% endcomment %}
          <a href="{% url 'lab_template_delete' template.id %}" onclick="return confirm('Are you sure?');">Delete</a>
      </li>
      {% endfor %}
  </ul>
</div>

<div class="container">
  <h2>Laboratories and Their Lab Templates</h2>
  {% for laboratory in my_laboratories %}
  <div class="laboratory">
    <h3>{{ laboratory.name }}</h3>
    <ul>
      {% for template in laboratory.lab_templates.all %}
      <li>
          <a href="{{ template.template_file.url }}">{{ template.name }}</a> - {{ template.course.name }}
          <a href="{% url 'lab_template_delete' template.id %}" onclick="return confirm('Are you sure?');">Delete</a>
      </li>
      {% empty %}
      <li>No lab templates available for this laboratory.</li>
      {% endfor %}
    </ul>
  </div>
  {% endfor %}
</div>

<!-- Example within labtech_dashboard.html -->

<a href="{% url 'add_section_type' %}">Add Section Type</a>
<!-- Include other links and content as needed -->
<h3>Section Types</h3>
<ul>
  {% for section_type in section_types %}
  <li>
    {{ section_type.name }}
    <form action="{% url 'delete_section_type' section_type.id %}" method="post" style="display:inline;">
      {% csrf_token %}
      <button type="submit" onclick="return confirm('Are you sure?');">Delete</button>
    </form>
  </li>
  {% endfor %}
</ul>

<h1>Lab Technician Dashboard</h1>

<ul>
  <li><a href="{% url 'lab_reports_for_grading' %}">Grade Lab Reports</a></li>
</ul>
<ul>
  
  <li><a href="{% url 'view_grades' %}">View Grades</a></li>
</ul>


{% endblock %}
