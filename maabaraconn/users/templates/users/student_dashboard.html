{% extends 'base.html' %} {% block content %}
<div class="container">
  <h1>Welcome, {{ request.user.username }}</h1>
  <section>
    <h2>My Enrolled Courses</h2>
    <ul>
      {% for course in request.user.enrolled_courses.all %}
      <li>
        <a href="{% url 'course_detail' course.id %}"
          >{{ course.name }} - {{ course.code }}</a
        >
        <form
          method="post"
          action="{% url 'unenroll_course' %}"
          style="display: inline"
        >
          {% csrf_token %}
          <input type="hidden" name="course_id" value="{{ course.id }}" />
          <button type="submit" class="btn btn-warning">Unenroll</button>
        </form>
      </li>
      {% endfor %}
    </ul>
  </section>

  <section>
    <h2>Lab Reports:</h2>
    {% for course in request.user.enrolled_courses.all %}
    <div>
      <h3>{{ course.name }} - {{ course.code }}</h3>
      {% for lab_report in course.lab_reports.all %}
      <p>
        <a href="{% url 'lab_report_detail' lab_report.id %}">
          {{ lab_report.title }}
        </a>
        - Due: {{ lab_report.due_date }}
      </p>
      <p>Course: {{ lab_report.course }}</p>
      <p>Description: {{ lab_report.description }}</p>
      <p>
        <a href="{% url 'student_lab_report_responses' lab_report.id %}"
          >View Your Responses</a
        >
      </p>
      {% empty %}
      <p>No lab reports available for this course.</p>
      {% endfor %}
    </div>
    {% endfor %}
  </section>

  <section>
    <h2>Available Courses</h2>
    {% for course in available_courses %}
    <div style="display: flex">
      <h3>{{ course.name }}</h3>
      <p>{{ course.description }}</p>
      {% if course not in request.user.enrolled_courses.all %}
      <form method="post" action="{% url 'enroll_course' %}">
        {% csrf_token %}
        <input type="hidden" name="course_id" value="{{ course.id }}" />
        <button type="submit" class="btn btn-primary">Enroll</button>
      </form>
      {% else %}
      <span>Already enrolled</span>
      {% endif %}
    </div>
    {% endfor %}
  </section>

  <section>
    <h2>Upcoming Lab Reports</h2>
    <!-- Implementation depends on how Lab Reports are linked to the student -->
  </section>

  <section>
    <h2>My Grades</h2>
    <!-- Implementation depends on how Grades are stored and linked to the student -->
  </section>
</div>
{% endblock %}
